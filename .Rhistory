body_add_par("",style = "pic_style")%>%
body_add_flextable(detail_info_ft)%>%
cursor_bookmark("mean_sd")%>%
body_add_flextable(mean_sd_ft)%>%
cursor_bookmark("pvalue")%>%
body_add_flextable(pvalue_ft)%>%
cursor_bookmark("raw_data")%>%
#body_add_flextable(raw_data_ft)%>%
#cursor_bookmark("conclusion")%>%
#body_add_flextable(conclusion_ft)%>%
cursor_bookmark("ggplot")%>%
body_add_gg(p,height = 3.5)
my_doc
}
print(my_doc,'克隆形成.docx')
pvalue_ft <-  p_value_table%>%
flextable() %>%
add_header_lines("表3.2.1  显著性差异检验")%>%
set_header_labels(sig_symbol='显著性')%>%
footnote(j=3,part = 'header',
value = as_paragraph('ns：P_value>0.05\n *：P_value≤0.05\n **：P_value≤0.01\n ***：P_value≤0.001\n ****：P_value≤0.0001\n')) %>%
align(align = 'center',part = 'all') %>%
fontsize(size = 9,part = 'all')%>%
autofit(add_h = 0.2) %>%
width(j = 1:2, width = 1.8)%>%
width(j = 3:4, width = 0.8)%>%
height(i=1,height = 1.7,part = 'foot')%>%
font(fontname = fontname, part = "all")
#统计作图
p <-  ggplot(mean_sd_data, aes(x=实验分组, y=Mean,fill =实验分组))+
geom_bar(stat = "identity",position="dodge",width = 0.5)+
geom_errorbar(aes(ymin=Mean-SD,ymax=Mean+SD),stat = "identity",
position=position_dodge(0.8),width=.2,color='grey')+
scale_y_continuous(expand = expand_scale(mult = c(0, .1)))+
theme(plot.title = element_text(face="bold"),
plot.title.position = "panel",
plot.subtitle = element_text(color = "grey"),
panel.background = element_rect(fill = NA),
axis.title= element_text(size = 12),
axis.text.x = element_text(size = 10,angle = 45,hjust = 1),
axis.line = element_line(colour = "black"),
axis.text.y = element_text(size = 10),
legend.position="none",
)+
scale_fill_viridis(option = 'E',discrete = T,alpha = 0.7)+
labs(x='',y='Number of Clones',title = "Colony Formation",
caption = "Plot by Syngenetech")
#仪器与试剂
#仪器
equip_name <- c('Sorvall Legend Mircro 17台式离心机',
'微量移液器','生物安全柜',
'恒温二氧化碳细胞培养箱','实验室耗材I(移液枪头、1.5/2.0mL离心管)',
'实验室耗材II(细胞培养皿、移液管等)','超低温冷冻冰箱',
'血球计数板')
equip_source <- c('美国ThermoFisher公司','德国Eppendorf公司',
'美国ThermoFisher公司','美国ThermoFisher公司',
'美国Axygen公司','美国Corning公司','美国ThermoFisher公司','求精')
equip_table <- data.frame(equip_name,equip_source)
equip_ft <- equip_table%>%
flextable()%>%
set_header_labels(equip_name='仪器名称',equip_source='生产厂家')%>%
add_header_lines(values = '表1.1.1  主要仪器及生产商')%>%
align(align = 'center',part = 'all')%>%
fontsize(size = 7.5,part = 'all')%>%
autofit(add_w = 0.7,add_h = 0.15)%>%
font(fontname = fontname, part = "all")
#试剂列表
regent_name <- c('DMEM高糖培养基','胰酶','多聚甲醛','结晶紫')
regent_source <- c('美国Gibco公司','美国Sigma公司','上海碧云天生物科技有限公司','上海碧云天生物科技有限公司')
regent_table <- data.frame(regent_name,regent_source)
regent_ft <- regent_table%>%
flextable()%>%
set_header_labels(regent_name='试剂名称',regent_source='生产厂家')%>%
footnote(i=1,j=1,part = 'header',value = as_paragraph('注：本部分实验涉及的其他试剂均为分析纯化学试剂。'))%>%
add_header_lines(values = '表1.2.1  主要试剂及生产商')%>%
align(align = 'center',part = 'all')%>%
fontsize(size = 7.5,part = 'all')%>%
autofit(add_w = 0.8,add_h = 0.17)%>%
height(height = 0.3,part = 'foot')%>%
font(fontname = fontname, part = "all")
#读入模板
my_doc <- read_docx('./data/colony_formation_templete.docx')
my_doc %>%
cursor_bookmark("contract_num")%>%
body_add_par(data_head[contract_num+1],style  = 'Subtitle')%>%
cursor_bookmark("date")%>%
body_add_par(value = Sys.Date(),style  = 'Subtitle')%>%
cursor_bookmark("equipment_info")%>%
body_add_flextable(equip_ft)%>%
cursor_bookmark("regent_info")%>%
body_add_flextable(regent_ft)%>%
cursor_bookmark("exp_group")%>%
body_add_flextable(exp_group_ft)%>%
body_add_par("",style = "pic_style")%>%
body_add_flextable(detail_info_ft)%>%
cursor_bookmark("mean_sd")%>%
body_add_flextable(mean_sd_ft)%>%
cursor_bookmark("pvalue")%>%
body_add_flextable(pvalue_ft)%>%
cursor_bookmark("raw_data")%>%
#body_add_flextable(raw_data_ft)%>%
#cursor_bookmark("conclusion")%>%
#body_add_flextable(conclusion_ft)%>%
cursor_bookmark("ggplot")%>%
body_add_gg(p,height = 3.5)
my_doc
}
print(my_doc,'克隆形成.docx')
library(ggpubr)
library(shiny)
library(reshape2)
library(openxlsx)
library(officer)
library(stringr)
library(dplyr)
library(flextable)
library(tidyr)
library(viridis)
dir('~/Desktop/使用教程和资料/输入模板示例/')
my_doc <- read_docx('./data/template.docx')
my_doc %>%
body_add_par('',style = 'Normal')%>%
body_bookmark("contract_num")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par("项目结题报告",style  = 'Title')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par(value = '',style  = 'Subtitle')%>%
body_bookmark('theme')
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_bookmark("date")%>%
body_add_break(pos = "after")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_flextable(value = preread_ft)%>%
body_add_break(pos = "after")%>%
body_add_par(my_doc,value = "载体构建信息", style = "heading 1")%>%
body_add_par(my_doc,value = "靶序列", style = "heading 2")%>%
body_add_par(value = "结果质控", style = "heading 1")%>%
body_add_par(value = "质粒酶切验证", style = "heading 2")%>%
body_add_par(value = "测序比对验证", style = "heading 2")%>%
body_add_par(value = "病毒滴度测定", style = "heading 2")%>%
body_add_par(value = "附录", style = "heading 1")%>%
body_add_par(value = "测序引物序列", style = "heading 2")%>%
body_add_par(value = "分子实验数据", style = "heading 2")%>%
body_add_par(value = "分子实验数据文件夹内含有质粒图谱、质粒示意图、测序比对文件及酶切鉴定照片等分子实验原始数据。", style = "chinese_style")%>%
body_add_par(value = "病毒实验数据", style = "heading 2")%>%
body_add_par(value = "病毒实验数据文件夹内含有质粒转染和慢病毒感染的原始图片。（注：质粒转染图片和滴度检测图片命名规则：载体编号-时间-物镜倍数-荧光类型。eg. LW429-48h-4×-G（G:绿光，R:红光，W：白光））", style = "chinese_style")
print(my_doc,target = './data/vector&vrius_templete.docx')
my_doc <- read_docx('./data/template.docx')
my_doc %>%
body_add_par('',style = 'Normal')%>%
body_bookmark("contract_num")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par("项目结题报告",style  = 'Title')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par(value = '',style  = 'Subtitle')%>%
body_bookmark('theme')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_bookmark("date")%>%
body_add_break(pos = "after")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_flextable(value = preread_ft)%>%
body_add_break(pos = "after")%>%
body_add_par(my_doc,value = "载体构建信息", style = "heading 1")%>%
body_add_par(my_doc,value = "靶序列", style = "heading 2")%>%
body_add_par(value = "结果质控", style = "heading 1")%>%
body_add_par(value = "质粒酶切验证", style = "heading 2")%>%
body_add_par(value = "测序比对验证", style = "heading 2")%>%
body_add_par(value = "病毒滴度测定", style = "heading 2")%>%
body_add_par(value = "附录", style = "heading 1")%>%
body_add_par(value = "测序引物序列", style = "heading 2")%>%
body_add_par(value = "分子实验数据", style = "heading 2")%>%
body_add_par(value = "分子实验数据文件夹内含有质粒图谱、质粒示意图、测序比对文件及酶切鉴定照片等分子实验原始数据。", style = "chinese_style")%>%
body_add_par(value = "病毒实验数据", style = "heading 2")%>%
body_add_par(value = "病毒实验数据文件夹内含有质粒转染和慢病毒感染的原始图片。（注：质粒转染图片和滴度检测图片命名规则：载体编号-时间-物镜倍数-荧光类型。eg. LW429-48h-4×-G（G:绿光，R:红光，W：白光））", style = "chinese_style")
print(my_doc,target = './data/vector&vrius_templete.docx')
my_doc <- read_docx('./data/template.docx')
my_doc %>%
body_add_par('',style = 'Normal')%>%
body_bookmark("contract_num")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par("项目结题报告",style  = 'Title')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par(value = '',style  = 'Subtitle')%>%
body_bookmark('theme')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_bookmark("date")%>%
body_add_break(pos = "after")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('pre_read_ft',style = 'pic_style')%>%
body_add_break(pos = "after")%>%
body_add_par(my_doc,value = "载体构建信息", style = "heading 1")%>%
body_add_par(my_doc,value = "靶序列", style = "heading 2")%>%
body_add_par(value = "结果质控", style = "heading 1")%>%
body_add_par(value = "质粒酶切验证", style = "heading 2")%>%
body_add_par(value = "测序比对验证", style = "heading 2")%>%
body_add_par(value = "病毒滴度测定", style = "heading 2")%>%
body_add_par(value = "附录", style = "heading 1")%>%
body_add_par(value = "测序引物序列", style = "heading 2")%>%
body_add_par(value = "分子实验数据", style = "heading 2")%>%
body_add_par(value = "分子实验数据文件夹内含有质粒图谱、质粒示意图、测序比对文件及酶切鉴定照片等分子实验原始数据。", style = "chinese_style")%>%
body_add_par(value = "病毒实验数据", style = "heading 2")%>%
body_add_par(value = "病毒实验数据文件夹内含有质粒转染和慢病毒感染的原始图片。（注：质粒转染图片和滴度检测图片命名规则：载体编号-时间-物镜倍数-荧光类型。eg. LW429-48h-4×-G（G:绿光，R:红光，W：白光））", style = "chinese_style")
print(my_doc,target = './data/vector&vrius_templete.docx')
my_doc <- read_docx('./data/template.docx')
my_doc %>%
body_add_par('',style = 'Normal')%>%
body_bookmark("contract_num")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par("项目结题报告",style  = 'Title')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par(value = '',style  = 'Subtitle')%>%
body_bookmark('theme')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_bookmark("date")%>%
body_add_break(pos = "after")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('pre_read_ft',style = 'pic_style')%>%
body_add_break(pos = "after")%>%
body_add_par(value = "载体构建信息", style = "heading 1")%>%
body_add_par(value = "靶序列", style = "heading 2")%>%
body_add_par(value = "结果质控", style = "heading 1")%>%
body_add_par(value = "质粒酶切验证", style = "heading 2")%>%
body_add_par(value = "测序比对验证", style = "heading 2")%>%
body_add_par(value = "病毒滴度测定", style = "heading 2")%>%
body_add_par(value = "附录", style = "heading 1")%>%
body_add_par(value = "测序引物序列", style = "heading 2")%>%
body_add_par(value = "分子实验数据", style = "heading 2")%>%
body_add_par(value = "分子实验数据文件夹内含有质粒图谱、质粒示意图、测序比对文件及酶切鉴定照片等分子实验原始数据。", style = "chinese_style")%>%
body_add_par(value = "病毒实验数据", style = "heading 2")%>%
body_add_par(value = "病毒实验数据文件夹内含有质粒转染和慢病毒感染的原始图片。（注：质粒转染图片和滴度检测图片命名规则：载体编号-时间-物镜倍数-荧光类型。eg. LW429-48h-4×-G（G:绿光，R:红光，W：白光））", style = "chinese_style")
print(my_doc,target = './data/vector&vrius_templete.docx')
dir('~/Desktop/使用教程和资料/输入模板示例/')
raw_data1 <- read.xlsx('~/Desktop/使用教程和资料/输入模板示例/载体构建和病毒包装.xlsx',sheet=1,startRow = 1)
raw_data2 <- read.xlsx('~/Desktop/使用教程和资料/输入模板示例/载体构建和病毒包装.xlsx',sheet=2,startRow = 3)
raw_data1 <- raw_data1
raw_data2 <- raw_data2
data_head <- raw_data1[,1]
target_info <- str_which(data_head, '靶序列信息')
ex_type <- str_which(data_head, '实验类型')
fun_type <- str_which(data_head, '靶序列功能')
contract_num <- str_which(data_head, '合同号')
primer_seq <- str_which(data_head, '测序引物信息')
titer <- str_which(data_head, '病毒滴度')
fontname <- "Arial"
exists(my_doc)
exists("my_doc")
data_head
?sapply()
?slip_in_img
raw_data1 <- raw_data1
raw_data2 <- raw_data2
data_head <- raw_data1[,1]
target_info <- str_which(data_head, '靶序列信息')
ex_type <- str_which(data_head, '实验类型')
fun_type <- str_which(data_head, '靶序列功能')
contract_num <- str_which(data_head, '合同号')
primer_seq <- str_which(data_head, '测序引物信息')
titer <- str_which(data_head, '病毒滴度')
fontname <- "Arial"
#产品信息速览表
preread_ft <- raw_data2 %>%
flextable()%>%
add_header_lines("产品信息速览表")%>%
bold(part = 'header')%>%
border_inner_h(border = fp_border(color="black", width = 1),part = 'body' )%>%
align(align = 'center',part = 'all')%>%
fontsize(i=1,size = 20,part = 'header')%>%
fontsize(i=2,size = 12,part = 'header')%>%
fontsize(j=-2,size = 10,part = 'body')%>%
fontsize(j=2,size = 7.5,part = 'body')%>%
autofit(add_h = 0,add_w = 0)%>%
height(height = 1,part = 'body')%>%
height(height = 0.4,part = 'header')%>%
width(j=2,width = 2.7)%>%
width(j=5,width = 0.9)%>%
width(j=6,width = 0.5)%>%
font(fontname = fontname, part = "all")
#载体信息表
target_info_data <-  raw_data1[(target_info+2):(primer_seq-1),]
colnames(target_info_data) <- raw_data1[(target_info+1),]
pict_height_coe <- length(target_info_data$`载体类型`)-length(target_info_data$`载体类型`[target_info_data$`载体类型`=='对照'])
if(pict_height_coe<=0){
pict_height_coe <- 1
}
#引物信息表
primer_seq_data <- raw_data1[(primer_seq+2):(titer-1),]
colnames(primer_seq_data) <- raw_data1[(primer_seq+1),]
primer_seq_ft <- primer_seq_data %>%
flextable(col_keys = c('载体编号','引物序列'))%>%
add_header_lines("测序引物序列")%>%
border_inner_h(border = fp_border(color="black", width = 1),part = 'body' )%>%
align(align = 'center',part = 'all')%>%
fontsize(size = 7.5,part = 'all')%>%
autofit(add_h = 0.2,add_w=0.5)%>%
font(fontname = fontname, part = "all")
#滴度表
titer_data <- raw_data1[(titer+2):nrow(raw_data1),]
colnames(titer_data) <- raw_data1[(titer+1),]
titer_data_ft <- titer_data%>%
flextable(col_keys = c('病毒编号','滴度','单位'))%>%
add_header_lines(values = '病毒滴度测定结果')%>%
border_inner_h(border = fp_border(color="black", width = 1),part = 'body' )%>%
align(align = 'center',part = 'all')%>%
fontsize(size = 10.5,part = 'body')%>%
fontsize(size = 12,part = 'header')%>%
bold(part = 'header')%>%
autofit(add_h = 0.2,add_w=0.2)%>%
font(fontname = fontname, part = "all")
my_doc <- read_docx('./data/vector&vrius_templete.docx')
cursor_reach(my_doc,keyword = "靶序列")
n <- nrow(target_info_data)
for(i in 1:n){
body_add_par(my_doc,target_info_data[i,1],style = 'Normal')
body_add_par(my_doc,target_info_data[i,2],style = 'Normal')
body_add_par(my_doc,target_info_data[i,4],style = 'seq')
body_add_par(my_doc,'',style = 'Normal')
}
pict_height <- length(antibody_info$`抗体种类`[antibody_info$`抗体种类`=="一抗"])*2
picture_list <- list('载体图谱')
index <- unlist(lapply(picture_list,function(x){
str_which(image_name,x)
}))
picture_list <- list('载体图谱')
index <- unlist(lapply(picture_list,function(x){
str_which(image_name,x)
}))
dir("~/Desktop/使用教程和资料/输入图片示例")
dir("~/Desktop/使用教程和资料/输入图片示例",pattern = '载体图谱.png')
dir("~/Desktop/使用教程和资料/输入图片示例",pattern = '载体图谱.*?.png')
image_name <- dir("~/Desktop/使用教程和资料/输入图片示例",pattern = '载体图谱.*?.png')
image_path <- file.path(image_name)
file.path(image_name)
image_name
?file.path
ile.path(image_name,fsep = '/')
file.path(image_name,fsep = '/')
image_name <- dir("~/Desktop/使用教程和资料/输入图片示例",pattern = '载体图谱.*?.png')
image_path <- c("~/Desktop/使用教程和资料/输入图片示例/载体图谱.png","~/Desktop/使用教程和资料/输入图片示例/载体图谱2.png")
image_name <- dir("~/Desktop/使用教程和资料/输入图片示例",pattern = '载体图谱.*?.png')
image_path <- c("~/Desktop/使用教程和资料/输入图片示例/载体图谱.png","~/Desktop/使用教程和资料/输入图片示例/载体图谱2.png")
image_path
picture_list <- list('载体图谱')
index <- unlist(lapply(picture_list,function(x){
str_which(image_name,x)
}))
pic_path <- image_path[index]
pic_name <- image_name[index]
pic_path
pic_name
index
for(pic in image_path){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,pic,width = 6.5,height = pict_height)
body_add_par()
}
my_doc <- read_docx('./data/template.docx')
my_doc %>%
body_add_par('',style = 'Normal')%>%
body_bookmark("contract_num")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par("项目结题报告",style  = 'Title')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par(value = '',style  = 'Subtitle')%>%
body_bookmark('theme')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_bookmark("date")%>%
body_add_break(pos = "after")%>%
body_add_par('',style = 'Normal')%>%
body_add_par('',style = 'Normal')%>%
body_add_par('pre_read_ft',style = 'pic_style')%>%
body_add_break(pos = "after")%>%
body_add_par(value = "载体构建信息", style = "heading 1")%>%
body_add_par(value = "靶序列", style = "heading 2")%>%
body_add_par(value = "载体图谱", style = "heading 2")%>%
body_add_par(value = "结果质控", style = "heading 1")%>%
body_add_par(value = "质粒酶切验证", style = "heading 2")%>%
body_add_par(value = "测序比对验证", style = "heading 2")%>%
body_add_par(value = "病毒滴度测定", style = "heading 2")%>%
body_add_par(value = "附录", style = "heading 1")%>%
body_add_par(value = "测序引物序列", style = "heading 2")%>%
body_add_par(value = "分子实验数据", style = "heading 2")%>%
body_add_par(value = "分子实验数据文件夹内含有质粒图谱、质粒示意图、测序比对文件及酶切鉴定照片等分子实验原始数据。", style = "chinese_style")%>%
body_add_par(value = "病毒实验数据", style = "heading 2")%>%
body_add_par(value = "病毒实验数据文件夹内含有质粒转染和慢病毒感染的原始图片。（注：质粒转染图片和滴度检测图片命名规则：载体编号-时间-物镜倍数-荧光类型。eg. LW429-48h-4×-G（G:绿光，R:红光，W：白光））", style = "chinese_style")
print(my_doc,target = './data/vector&vrius_templete.docx')
my_doc <- read_docx('./data/vector&vrius_templete.docx')
cursor_reach(my_doc,keyword = "靶序列")
n <- nrow(target_info_data)
for(i in 1:n){
body_add_par(my_doc,target_info_data[i,1],style = 'Normal')
body_add_par(my_doc,target_info_data[i,2],style = 'Normal')
body_add_par(my_doc,target_info_data[i,4],style = 'seq')
body_add_par(my_doc,'',style = 'Normal')
}
picture_list <- list('载体图谱')
index <- unlist(lapply(picture_list,function(x){
str_which(image_name,x)
}))
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = pict_height)
body_add_par(image_name[pic],style = "pic_style")
}
picture_list <- list('载体图谱')
index <- unlist(lapply(picture_list,function(x){
str_which(image_name,x)
}))
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
body_add_par(image_name[pic],style = "pic_style")
}
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
body_add_par(my_doc,image_name[pic],style = "pic_style")
}
print(my_doc,'载体构建和病毒包装.docx')
my_doc <- read_docx('./data/vector&vrius_templete.docx')
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
body_add_par(my_doc,image_name[pic],style = "pic_style")
}
print(my_doc,'载体构建和病毒包装.docx')
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
slip_in_text(my_doc,image_name[pic],style = "pic_style")
}
?slip_in_text
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
slip_in_text(my_doc,image_name[pic])
}
print(my_doc,'载体构建和病毒包装.docx')
my_doc <- read_docx('./data/template.docx')
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
slip_in_text(my_doc,image_name[pic])
}
my_doc <- read_docx('./data/vector&vrius_templete.docx')
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
slip_in_text(my_doc,image_name[pic])
}
print(my_doc,'载体构建和病毒包装.docx')
#读入模板
my_doc <- read_docx('./data/vector&vrius_templete.docx')
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
body_add_par(my_doc,"",style = "pic_style")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
slip_in_text(my_doc,image_name[pic])
}
print(my_doc,'载体构建和病毒包装.docx')
index
sort(index,decreasing = T)
index <- sort(index,decreasing = T)
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
body_add_par(my_doc,"",style = "pic_style")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
slip_in_text(my_doc,image_name[pic])
}
#读入模板
my_doc <- read_docx('./data/vector&vrius_templete.docx')
index <- unlist(lapply(picture_list,function(x){
str_which(image_name,x)
}))
index <- sort(index,decreasing = T)
for(pic in index){
cursor_reach(my_doc,keyword = "载体图谱")
body_add_par(my_doc,"",style = "pic_style")
slip_in_img(my_doc,image_path[pic],width = 6.5,height = 6)
slip_in_text(my_doc,image_name[pic])
}
print(my_doc,'载体构建和病毒包装.docx')
